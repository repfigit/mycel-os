import { sha256 } from '@noble/hashes/sha2.js';
import { serialize } from 'borsh';
export const Nep413MessageSchema = {
    struct: {
        message: 'string',
        nonce: { array: { type: 'u8', len: 32 } },
        recipient: 'string',
        callbackUrl: { option: 'string' },
    },
};
export function serializeMessage(payload) {
    // 2**31 + 413 == 2147484061
    const PREFIX = 2147484061;
    const serializedPrefix = serialize('u32', PREFIX);
    const serializedParams = serialize(Nep413MessageSchema, payload);
    const serializedPayload = new Uint8Array(serializedPrefix.length + serializedParams.length);
    serializedPayload.set(serializedPrefix);
    serializedPayload.set(serializedParams, serializedPrefix.length);
    return new Uint8Array(sha256(serializedPayload));
}
